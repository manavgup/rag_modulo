# 🔐 Environment Setup Guide

This guide helps you set up a working `.env` file to run the RAG Modulo project.

## 🚀 Quick Start

```bash
# 1. Interactive setup (recommended)
make setup-env

# 2. Fill in your API keys in .env
# Edit the 🔐 CRITICAL SECRETS section

# 3. Validate setup
make validate-env

# 4. Test everything works
make tests
```

## 📋 Required Credentials

### Critical API Keys (Required)
- **WATSONX_APIKEY** - Get from [IBM Cloud > Watson AI](https://cloud.ibm.com/catalog/services/watson-machine-learning)
- **OPENAI_API_KEY** - Get from [OpenAI Platform](https://platform.openai.com/api-keys)
- **ANTHROPIC_API_KEY** - Get from [Anthropic Console](https://console.anthropic.com/settings/keys)
- **JWT_SECRET_KEY** - Auto-generated by setup script

### IBM Integration
- **IBM_CLIENT_ID** - From IBM Cloud app registration
- **IBM_CLIENT_SECRET** - From IBM Cloud app registration
- **WATSONX_INSTANCE_ID** - From Watson AI service details
- **WATSONX_URL** - Watson AI endpoint (defaults to us-south region)

### Database & Storage
- **MINIO_ROOT_USER/PASSWORD** - MinIO credentials (default: minioadmin/minioadmin)
- **COLLECTIONDB_USER/PASS** - PostgreSQL credentials

## 🛠️ Manual Setup

If you prefer manual setup:

```bash
# Copy template
cp .env.example .env

# Generate JWT secret
openssl rand -hex 32

# Edit .env with your values
# Focus on the 🔐 CRITICAL SECRETS section
```

## 🔍 Validation

The setup includes automatic validation:

```bash
# Check all required variables
make validate-env

# Get help with missing credentials
make env-help

# See all environment commands
make help | grep -A 5 "Environment Setup"
```

## 🚨 Troubleshooting

### Container Failures
- **Milvus fails with "Access Denied"** → Check MinIO credentials
- **Tests fail immediately** → Run `make validate-env`

### Missing Credentials
- **API key errors** → Verify keys are valid and not expired
- **Connection errors** → Check network endpoints and credentials

### Common Issues
```bash
# Missing .env file
make setup-env

# Wrong file format
cp .env.example .env

# Permission errors
chmod 600 .env
```

## 🔒 Security Best Practices

### Local Development
- ✅ Never commit `.env` to git (already in `.gitignore`)
- ✅ Use separate credentials for dev/prod
- ✅ Rotate API keys regularly
- ✅ Keep `.env` file permissions restricted (`chmod 600`)

### Team Sharing
- 🔐 Share credentials via secure channels (1Password, Bitwarden)
- 📝 Document where to get each credential
- 🔄 Use GitHub Secrets for CI/CD
- 🚨 Rotate keys if accidentally exposed

## 📚 Advanced Configuration

### Environment Layers
```bash
.env.example      # Template (committed)
.env.defaults     # Default values (can commit)
.env.development  # Dev overrides (can commit)
.env.local        # Personal overrides (never commit)
.env              # Final values (never commit)
```

### GitHub Actions
Configure secrets in repository settings:
- `WATSONX_APIKEY`
- `OPENAI_API_KEY`
- `ANTHROPIC_API_KEY`
- etc.

### Production Deployment
Consider using:
- AWS Secrets Manager
- Azure Key Vault
- HashiCorp Vault
- Google Secret Manager

## 🆘 Getting Help

1. **Quick help**: `make env-help`
2. **Validation issues**: `make validate-env`
3. **GitHub issue**: File an issue with your error message
4. **Team members**: Check team credential sharing docs

## 🎯 Next Steps

Once your environment is set up:

1. **Run tests**: `make tests`
2. **Start development**: `make run-app`
3. **Code quality**: `make check-fast`

---

> **💡 Pro Tip**: Bookmark this guide and share with new team members!
