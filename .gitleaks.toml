# Gitleaks configuration for RAG Modulo
# Detects secrets in code, including IBM Cloud API keys, AWS keys, and more

title = "RAG Modulo Gitleaks Configuration"

[extend]
# Use default Gitleaks rules
useDefault = true

# Additional custom rules for IBM Cloud and infrastructure secrets
[[rules]]
id = "ibm-cloud-api-key"
description = "IBM Cloud API Key"
regex = '''(?i)(ibm_cloud_api_key|ibmcloud_api_key|IC_API_KEY)\s*[:=]\s*["'][A-Za-z0-9_-]{44}["']'''
keywords = [
    "ibm_cloud_api_key",
    "ibmcloud_api_key",
    "IC_API_KEY",
]

[[rules]]
id = "terraform-sensitive-values"
description = "Terraform sensitive values in .tfvars files"
path = '''\.tfvars$'''
regex = '''(?i)(api_key|password|secret|token)\s*=\s*["'][^"']+["']'''

[[rules]]
id = "ansible-vault-unencrypted"
description = "Unencrypted secrets in Ansible files"
path = '''(ansible|playbook).*\.ya?ml$'''
regex = '''(?i)(api_key|password|secret|token):\s*["']?[A-Za-z0-9_-]{20,}["']?'''

# Allowlist for false positives
[allowlist]
description = "Allowlist for safe patterns"
regexes = [
    '''YOUR_.*_HERE''',  # Example placeholders
    '''example\.com''',  # Example domains
    '''test-.*-key''',   # Test keys
    '''mock-.*''',       # Mock values
    '''\$\{.*\}''',      # Environment variable references
]

paths = [
    '''\.example$''',           # Example files
    '''\.tfvars\.example$''',   # Terraform example files
    '''\.env\.example$''',      # Env example files
    '''^docs/''',               # Documentation
    '''^tests/fixtures/''',     # Test fixtures
    '''^test-reports/''',       # Test reports
]

# Commits to exclude (if any)
commits = []
